<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ê–¥–º–∏–Ω–∫–∞ ‚Äî Mirror's Edge Catalyst</title>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/admin.css">
  
  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/screenshots.js"></script>
  <script src="js/admin.js"></script>
</head>
<body class="bg-dark text-white" style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">

  <!-- === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –í–•–û–î–ê === -->
  <div id="loginModal" class="modal-backdrop" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 1050;">
    <div class="text-center" style="color: white; max-width: 400px; padding: 30px; background: #2c3e50; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.4);">
      <h4><i class="fas fa-lock text-warning"></i> –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω–∫—É</h4>
      <p class="text-muted small mt-2">–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏—Å—Å–∏–π</p>
      <input type="password" id="adminPassword" class="form-control mt-3" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autofocus>
      <div id="passwordError" class="text-danger mt-2 d-none">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!</div>
      <button onclick="checkPassword()" class="btn btn-success mt-3 px-4">
        <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
      </button>
    </div>
  </div>

  <!-- === –û–°–ù–û–í–ù–ê–Ø –ê–î–ú–ò–ù–ö–ê (–∏–∑–Ω–∞—á–∞–ª—å–Ω–æ —Å–∫—Ä—ã—Ç–∞) === -->
  <div id="adminPanel" style="display: none; width: 100%;">
    <div class="container my-5">

      <!-- –í–∫–ª–∞–¥–∫–∏ -->
      <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
          <a class="nav-link active" data-bs-toggle="tab" href="#missions">–ú–∏—Å—Å–∏–∏</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-bs-toggle="tab" href="#screenshots">–°–∫—Ä–∏–Ω—à–æ—Ç—ã</a>
        </li>
      </ul>

      <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
      <div class="tab-content">

        <!-- –í–ö–õ–ê–î–ö–ê: –ú–ò–°–°–ò–ò -->
        <div class="tab-pane fade show active" id="missions">
          <!-- –ö–Ω–æ–ø–∫–∞: –î–æ–±–∞–≤–∏—Ç—å –º–∏—Å—Å–∏—é -->
          <div class="mb-4">
            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addMissionModal">
              <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –º–∏—Å—Å–∏—é
            </button>
          </div>

          <!-- –°–ø–∏—Å–æ–∫ –º–∏—Å—Å–∏–π -->
          <div class="card shadow-sm">
            <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
              <h5 class="mb-0">–°–ø–∏—Å–æ–∫ –º–∏—Å—Å–∏–π</h5>
              <button onclick="saveToServer()" class="btn btn-primary mt-3">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
              </button>
            </div>
            <ul id="missionsList" class="list-group list-group-flush"></ul>
          </div>
        </div>

        <!-- –í–ö–õ–ê–î–ö–ê: –°–ö–†–ò–ù–®–û–¢–´ -->
        <div class="tab-pane fade" id="screenshots">
          <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ -->
          <div class="card shadow-sm mb-4">
            <div class="card-header bg-dark text-white">
              <h5 class="mb-0">–î–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</h5>
            </div>
            <div class="card-body">
              <form id="screenshotForm">
                <div class="mb-3">
                  <label class="form-label">–°–ø–æ—Å–æ–± –¥–æ–±–∞–≤–ª–µ–Ω–∏—è</label>
                  <div class="btn-group d-block" role="group">
                    <input type="radio" class="btn-check" name="srcType" id="srcUrl" autocomplete="off" checked>
                    <label class="btn btn-outline-primary" for="srcUrl">–ü–æ —Å—Å—ã–ª–∫–µ</label>
                    <input type="radio" class="btn-check" name="srcType" id="srcFile" autocomplete="off">
                    <label class="btn btn-outline-success" for="srcFile">–§–∞–π–ª —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞</label>
                  </div>
                </div>
                <div id="urlField" class="mb-3">
                  <label class="form-label">–°—Å—ã–ª–∫–∞ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</label>
                  <input type="url" class="form-control" id="screenshotSrc">
                </div>
                <div id="fileField" class="mb-3" style="display: none;">
                  <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª</label>
                  <input type="file" class="form-control" id="screenshotFile" accept="image/*">
                  <small class="text-muted">–§–æ—Ä–º–∞—Ç—ã: JPG, PNG, WEBP (–¥–æ 5 –ú–ë)</small>
                </div>
                <div class="mb-3">
                  <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ (alt)</label>
                  <input type="text" class="form-control" id="screenshotAlt" required>
                </div>
                <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å</button>
              </form>
            </div>
          </div>

          <!-- –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ -->
          <div class="card shadow-sm">
            <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
              <h5 class="mb-0">–¢–µ–∫—É—â–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã</h5>
              <button onclick="saveToServer()" class="btn btn-primary mt-3">
                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
              </button>
            </div>
            <ul id="screenshotsList" class="list-group list-group-flush"></ul>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –î–û–ë–ê–í–ò–¢–¨ –ú–ò–°–°–ò–Æ –° –¢–ï–ö–°–¢–û–ú === -->
  <div class="modal fade" id="addMissionModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content bg-dark text-white">
        <div class="modal-header">
          <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –º–∏—Å—Å–∏—é</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" style="filter: invert(1);"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">–ù–æ–º–µ—Ä</label>
            <input type="number" class="form-control" id="newMissionId" required>
          </div>
          <div class="mb-3">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" class="form-control" id="newMissionTitle" required>
          </div>
          <div class="mb-3">
            <label class="form-label">–ö—Ä–∞—Ç–∫–æ (–ø–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫)</label>
            <input type="text" class="form-control" id="newMissionSubtitle" placeholder="‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–±–æ—Ä —á–∏–ø–æ–≤">
          </div>

          <!-- –†–µ–¥–∞–∫—Ç–æ—Ä -->
          <div class="editor-toolbar mb-2">
            <button type="button" class="btn btn-sm btn-outline-light" onclick="insertTextToEditor('<p>–ù–æ–≤—ã–π –∞–±–∑–∞—Ü</p>')">üìÑ</button>
            <button type="button" class="btn btn-sm btn-outline-light" onclick="insertTextToEditor('<h3>–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>')">H3</button>
            <button type="button" class="btn btn-sm btn-outline-light" onclick="insertTextToEditor('<strong>–ñ–∏—Ä–Ω—ã–π</strong>')"><b>B</b></button>
            <button type="button" class="btn btn-sm btn-outline-light" onclick="insertTextToEditor('<em>–ö—É—Ä—Å–∏–≤</em>')"><i>I</i></button>
            <button type="button" class="btn btn-sm btn-outline-success" onclick="addImageToNewEditor()">üñºÔ∏è –ö–∞—Ä—Ç–∏–Ω–∫–∞</button>
          </div>

          <div id="newMissionEditor" contenteditable="true" class="editor-container" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç –º–∏—Å—Å–∏–∏ –∑–¥–µ—Å—å..."></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn btn-success" id="saveNewMission">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –°–ö–†–ò–ù–®–û–¢ === -->
  <div id="editScreenshotModal" class="modal fade" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="text-center px-4 mt-3">
          <img id="editScreenshotPreview" src="https://via.placeholder.com/400x225?text=–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä" alt="–ü—Ä–µ–≤—å—é" class="img-fluid rounded-3 shadow-sm" style="height: 200px; object-fit: cover;">
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ (alt)</label>
            <input type="text" class="form-control" id="editScreenshotAlt">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
          <button type="button" class="btn btn-success" id="saveEditScreenshot">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
      </div>
    </div>
  </div>

  <!-- === –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û: –ü–û–õ–ù–´–ô –†–ê–ó–ú–ï–† === -->
  <div id="fullscreenModal" class="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 9999; opacity: 0; visibility: hidden; transition: opacity 0.3s; cursor: pointer;">
    <div style="position: relative;">
      <button type="button" class="btn btn-outline-light btn-sm rounded-circle" style="position: absolute; top: 10px; right: 10px; width: 36px; height: 36px; z-index: 10; font-size: 1.2rem; padding: 0; display: flex; align-items: center; justify-content: center;" onclick="closeFullscreen()">√ó</button>
      <img id="fullscreenImage" style="max-width: 90vw; max-height: 90vh; border-radius: 8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); object-fit: contain;">
    </div>
  </div>

  <style>
    #fullscreenModal.show {
      opacity: 1 !important;
      visibility: visible !important;
    }
  </style>

</body>
</html>
